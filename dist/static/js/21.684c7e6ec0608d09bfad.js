webpackJsonp([21],{"+hcf":function(e,t,i){"use strict";(function(e){t.a={data:function(){var e=this;return{tableColumns:[{title:"游戏内id",key:"id",align:"center",width:100},{title:"名称",key:"name",align:"center",width:150},{title:"头像",key:"avatar",align:"center",width:80,render:function(e,t){return-1==t.row.avatar.indexOf("http://")&&-1==t.row.avatar.indexOf("https://")?e("div",""):e("img",{attrs:{src:t.row.avatar},style:{width:"40px",height:"40px","border-radius":"5px","margin-top":"5px"}})}},{title:"所属商务",key:"commerceName",align:"center",width:100},{title:"代理等级",key:"agentLevelName",align:"center",width:100},{title:"直属返利比例",key:"directRebateRatio",align:"center",width:120,render:function(e,t){return t.row.isBeingEdited?e("InputNumber",{props:{value:t.row.directRebateRatioInputValue,step:.01,min:0,max:1,formatter:function(e){return(100*e).toFixed(0)+"%"},parser:function(e){return(.01*e.replace("%","")).toFixed(2)}},on:{"on-change":function(e){t.row.directRebateRatioInputValue=e}}}):e("div",(100*t.row.directRebateRatio).toFixed(0)+"%")}},{title:"下级返利比例",key:"subordinateRebateRatio",align:"center",width:120,render:function(e,t){return t.row.isBeingEdited?e("InputNumber",{props:{value:t.row.subordinateRebateRatioInputValue,step:.01,min:0,max:1,formatter:function(e){return(100*e).toFixed(0)+"%"},parser:function(e){return(.01*e.replace("%","")).toFixed(2)}},on:{"on-change":function(e){t.row.subordinateRebateRatioInputValue=e}}}):e("div",(100*t.row.subordinateRebateRatio).toFixed(0)+"%")}},{title:"操作",key:"action",render:function(t,i){return i.row.isBeingEdited?t("div",[t("Button",{props:{type:"primary"},style:{marginRight:"5px"},on:{click:function(){e.submitRowChange(i.row)}}},"确定"),t("Button",{props:{type:"error"},on:{click:function(){e.cancelRowChange(i.index)}}},"取消")]):i.row.hasIndividualRebateRatio?t("div",[t("Button",{props:{type:"primary"},style:{marginRight:"5px"},on:{click:function(){e.beginChangeRow(i.index)}}},"调整独立返利比例"),t("Button",{props:{type:"error"},on:{click:function(){e.onClickIndividualRebateRatioCancelBtn(i.row)}}},"取消独立返利比例")]):t("Button",{props:{type:"primary"},style:{marginRight:"5px"},on:{click:function(){e.beginChangeRow(i.index)}}},"授予独立返利比例")}}],tableRows:[],searchedAgentId:"",beingEditedRowIndex:-1,isShowingAgentWithoutIndividualRebateRatio:!1,latestSearch:null}},created:function(){this.queryAllAgentsWithIndividualRebateRatio()},methods:{handleSearchAgent:function(){if(0==this.searchedAgentId.trim().length)this.queryAllAgentsWithIndividualRebateRatio();else{var e=parseInt(this.searchedAgentId.trim());if(isNaN(e)||e<=0)return void this.$Message.error("请正确输入代理id");this.queryAgentRebateRatioInfo(e)}},queryAllAgentsWithIndividualRebateRatio:function(){var t=this;this.tableRows=[],this.isShowingAgentWithoutIndividualRebateRatio=!1,this.$http.post(e.url.query_agents_individual_rebate_ratio_info,{}).then(function(e){if(e)for(var i=0;i<e.length;i++)t.tableRows.push({id:e[i].agent_id,name:e[i].name,avatar:e[i].avatar,commerceId:e[i].commerce_id,commerceName:e[i].commerce_name,directRebateRatio:e[i].direct_rebate_ratio,subordinateRebateRatio:e[i].subordinate_rebate_ratio,hasIndividualRebateRatio:1==e[i].has_individual_rebate_ratio,agentLevelName:t.getAgentLevelNameByLevel(e[i].agent_level),directRebateRatioInputValue:0,subordinateRebateRatioInputValue:0,isBeingEdited:!1})}),this.latestSearch=function(){t.queryAllAgentsWithIndividualRebateRatio()}},queryAgentRebateRatioInfo:function(t){var i=this;this.tableRows=[],this.isShowingAgentWithoutIndividualRebateRatio=!1,this.$http.post(e.url.query_agent_individual_rebate_ratio_info,{agentId:t}).then(function(e){e&&(0==e.err_code?(i.tableRows.push({id:e.agent_id,name:e.name,avatar:e.avatar,commerceId:e.commerce_id,commerceName:e.commerce_name,directRebateRatio:e.direct_rebate_ratio,subordinateRebateRatio:e.subordinate_rebate_ratio,hasIndividualRebateRatio:1==e.has_individual_rebate_ratio,agentLevelName:i.getAgentLevelNameByLevel(e.agent_level),directRebateRatioInputValue:0,subordinateRebateRatioInputValue:0,isBeingEdited:!1}),i.isShowingAgentWithoutIndividualRebateRatio=0==e.has_individual_rebate_ratio):i.$Message.error(e.err_msg))}),this.latestSearch=function(){i.queryAgentRebateRatioInfo(t)}},submitRowChange:function(t){var i=this;this.$http.post(e.url.update_agent_individual_rebate_ratio_info,{agentId:t.id,directRebateRatio:t.directRebateRatioInputValue,subordinateRebateRatio:t.subordinateRebateRatioInputValue}).then(function(e){e&&(0!=e.err_code?i.$Message.error(e.err_msg):(i.$Message.info("操作成功"),t.isBeingEdited=!1,i.latestSearch()))})},cancelRowChange:function(e){this.tableRows[e].isBeingEdited=!1,this.beingEditedRowIndex=-1},beginChangeRow:function(e){this.beingEditedRowIndex>=0&&this.cancelRowChange(this.beingEditedRowIndex),this.tableRows[e].isBeingEdited=!0,this.beingEditedRowIndex=e,this.tableRows[e].directRebateRatioInputValue=this.tableRows[e].directRebateRatio,this.tableRows[e].subordinateRebateRatioInputValue=this.tableRows[e].subordinateRebateRatio},onClickIndividualRebateRatioCancelBtn:function(e){var t=this;this.$Modal.confirm({content:"<p>即将取消代理【"+e.name+"】的独立返利比例</p><p>取消后，该代理的返利比例将会是与其等级对应的默认值</p>",onOk:function(){t.cancelIndividualRebateRatio(e.id)}})},cancelIndividualRebateRatio:function(t){var i=this;this.$http.post(e.url.cancel_agent_individual_rebate_ratio,{agentId:t}).then(function(e){e&&(0!=e.err_code?i.$Message.error(e.err_msg):(i.$Message.info("操作成功"),i.latestSearch()))})},getAgentLevelNameByLevel:function(e){switch(e.toString()){case"1":return"预备代理";case"2":return"普通代理";case"3":return"铜牌代理";case"4":return"银牌代理";case"5":return"金牌代理";default:return""}}}}}).call(t,i("DuR2"))},"3YIX":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("+hcf"),n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"content-bar"},[i("Form",{attrs:{inline:""}},[i("FormItem",{attrs:{label:"代理ID","label-width":80}},[i("Input",{staticStyle:{width:"10em"},attrs:{placeholder:"代理ID",maxlength:6,clearable:""},model:{value:e.searchedAgentId,callback:function(t){e.searchedAgentId=t},expression:"searchedAgentId"}})],1),e._v(" "),i("FormItem",{attrs:{"label-width":0}},[i("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:e.handleSearchAgent}},[e._v("查询")])],1)],1)],1),e._v(" "),i("div",{staticStyle:{"margin-top":"10px"}},[e.isShowingAgentWithoutIndividualRebateRatio?i("div",{staticStyle:{color:"red"}},[e._v("该代理尚未被授予独立返利比例：")]):i("div",[e._v("被授予独立返利比例的代理：")])]),e._v(" "),i("Table",{attrs:{columns:e.tableColumns,data:e.tableRows,border:""}})],1)},staticRenderFns:[]};var r=function(e){i("bxTR")},o=i("VU/8")(a.a,n,!1,r,null,null);t.default=o.exports},bxTR:function(e,t){}});
//# sourceMappingURL=21.684c7e6ec0608d09bfad.js.map