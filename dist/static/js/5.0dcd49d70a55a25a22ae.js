webpackJsonp([5],{A3Wl:function(t,e,n){"use strict";(function(t){var o=n("mvHQ"),r=n.n(o),i=n("NC6I"),c=n.n(i);e.a={data:function(){return{accountId:0,formItem:{account:"",password:"123456",role:"",nickname:""},isRoterAlive:!0,roleList:[],linkList:[],arrRoleLink:[],isSubmit:!0,link:[]}},created:function(){this.getRole(),this.getLinkList(),this.$route.query.id&&(this.accountId=this.$route.query.id,this.getAccount())},methods:{getAccount:function(){var e=this;e.$http.get(t.url.account_find,{accountId:e.accountId}).then(function(t){e.formItem.account=t.account,e.formItem.role=t.roleId,e.formItem.nickname=t.nickname,e.link=t.link,e.selectLink(1)})},selectLink:function(e){var n=this,o=[];if(e){var r=n.link;r=r.split(","),o=r}else n.roleList.find(function(t,e){t.roleId==n.formItem.role&&(o=t.linkid.split(","))});o.length,n.$http.get(t.url.role_linklist).then(function(t){n.jsonLink(t),n.linkList.map(function(t){t.map(function(t){t.children&&t.children.map(function(t){o.includes(t.key.toString())&&(t.checked=!0)})})})})},reload:function(){this.isRoterAlive=!1,this.$nextTick(function(){this.isRoterAlive=!0})},exists:function(){var e=this;""!=e.formItem.account&&e.$http.get(t.url.account_exists,{account:e.formItem.account}).then(function(t){t&&null!=t?(e.$Message.error("账号已存在!"),e.isSubmit=!1):e.isSubmit=!0})},save:function(e){var n=this;RegExp("/(^s*)|(s*$)/g");return""==n.$trim(n.formItem.nickname)?(n.$Message.error("昵称不能为空!"),!1):""==n.$trim(n.formItem.account)?(n.$Message.error("账号不能为空!"),!1):n.isSubmit?""==n.$trim(n.formItem.password)?(n.$Message.error("密码不能为空!"),!1):""==n.formItem.role?(n.$Message.error("请选择角色!"),!1):(n.linkList.map(function(t){t.map(function(t){t.children&&t.children.map(function(e){1==e.checked&&(n.arrRoleLink.includes(t.key)||n.arrRoleLink.push(t.key),n.arrRoleLink.includes(e.key)||n.arrRoleLink.push(e.key))})})}),void this.$http.post(t.url.account_add,{accountId:n.accountId,account:n.formItem.account,password:c()(n.formItem.password),nickname:n.formItem.nickname,roleid:n.formItem.role,link:r()(n.arrRoleLink),isAdd:0==n.accountId}).then(function(t){var e=0==n.accountId?"添加成功!":"修改成功";n.$Message.success(e),n.$router.push({path:"/account"})}).catch(function(t){n.$Message.error("添加失败!")})):(n.$Message.error("账号已存在!"),!1)},handleReset:function(t){this.accountId=0,this.formItem={account:"",password:"",role:"role",nickname:""},this.getLinkList()},handCancel:function(){this.$router.push({path:"/account"})},getRole:function(){var e=this;this.$http.get(t.url.role_list).then(function(t){e.roleList=t})},getLinkList:function(){var e=this;this.$http.get(t.url.role_linklist).then(function(t){e.jsonLink(t)})},jsonLink:function(t){if(this.linkList=[],t){var e=[];t.forEach(function(t){null===t.parentLinkId&&e.push({key:t.linkId,title:t.name,expand:!1,children:[]})}),t.forEach(function(t){e.forEach(function(e){t.parentLinkId==e.key&&e.children.push({key:t.linkId,title:t.name,expand:!0,children:[]})})}),t.forEach(function(t){e.forEach(function(e){e.children.forEach(function(e){t.parentLinkId==e.key&&e.children.push({key:t.linkId,title:t.name,expand:!0})})})}),e&&this.linkList.push(e)}}}}}).call(e,n("DuR2"))},I5IU:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("A3Wl"),r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.isRoterAlive?n("router-view",[t._v("1")]):t._e(),t._v(" "),n("Card",{attrs:{bordered:!1}},[n("Form",{attrs:{"label-width":80},model:{value:t.formItem,callback:function(e){t.formItem=e},expression:"formItem"}},[n("FormItem",{attrs:{label:"用户昵称:"}},[n("Input",{staticStyle:{width:"300px"},attrs:{maxlength:20,type:"text",placeholder:"请输入昵称..."},model:{value:t.formItem.nickname,callback:function(e){t.$set(t.formItem,"nickname",e)},expression:"formItem.nickname"}})],1),t._v(" "),n("FormItem",{attrs:{label:"登录账户:"}},[n("Input",{staticStyle:{width:"300px"},attrs:{maxlength:20,type:"text",placeholder:"请输入账号..."},on:{"on-blur":function(e){t.exists()}},model:{value:t.formItem.account,callback:function(e){t.$set(t.formItem,"account",e)},expression:"formItem.account"}})],1),t._v(" "),0==t.accountId?n("FormItem",{attrs:{label:"登录密码:"}},[n("Input",{staticStyle:{width:"300px"},attrs:{maxlength:20,type:"password",placeholder:"请输入密码..."},model:{value:t.formItem.password,callback:function(e){t.$set(t.formItem,"password",e)},expression:"formItem.password"}}),t._v(" "),n("small",{staticStyle:{color:"red"}},[t._v("默认为:123456")])],1):t._e(),t._v(" "),n("FormItem",{attrs:{label:"选择角色:"}},t._l(t.roleList,function(e,o){return n("RadioGroup",{key:o,on:{"on-change":function(e){t.selectLink()}},model:{value:t.formItem.role,callback:function(e){t.$set(t.formItem,"role",e)},expression:"formItem.role"}},[n("Radio",{attrs:{label:e.roleId}},[t._v(t._s(e.roleName))])],1)})),t._v(" "),n("FormItem",{attrs:{label:"选择权限:"}},[n("Col",[n("FormItem",t._l(t.linkList,function(t,e){return n("Card",{key:e,staticStyle:{width:"300px"},attrs:{bordered:!1}},[n("Tree",{ref:"Tree",refInFor:!0,attrs:{data:t,"show-checkbox":""}})],1)}))],1)],1),t._v(" "),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:function(e){t.save("ruleForm")}}},[t._v("保存")]),t._v(" "),n("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.handCancel}},[t._v("取消")])],1)],1)],1)],1)},staticRenderFns:[]},i=n("VU/8")(o.a,r,!1,null,null,null);e.default=i.exports},mvHQ:function(t,e,n){t.exports={default:n("qkKv"),__esModule:!0}},qkKv:function(t,e,n){var o=n("FeBl"),r=o.JSON||(o.JSON={stringify:JSON.stringify});t.exports=function(t){return r.stringify.apply(r,arguments)}}});
//# sourceMappingURL=5.0dcd49d70a55a25a22ae.js.map